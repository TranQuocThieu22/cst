<div class="card border-0">
  <ngx-spinner name="up" [fullScreen]="false" type="ball-clip-rotate-multiple" size="medium"></ngx-spinner>

  <div class="card-body">
    <div class="container-fluid">
      <div class="text-center">

        <div class="row">
          <div class="col-sm text-center">
            <img src="../assets/images/2.png" onerror="this.src='assets/images/no_img.png'" />
          </div>
        </div>

        <div class="row mt-1">
          <div class="col-sm text-center">
            <a class="text-decoration-none clickable" [routerLink]="" routerLinkActive="router-link-active"
              (click)="exportfileCauTruc()">Xuất file cấu trúc mẫu</a>
          </div>
        </div>

        <div class="row mt-3">
          <div class="col"></div>
          <div class="col-sm text-center">
            <div class="input-group">
              <div class="custom-file">
                <input type="file" class="custom-file-input" id="txt" accept=".xlsx" (change)="getFile($event)">
                <label class="custom-file-label text-left" for="txt">{{FileName || ''}}</label>
              </div>
              <div class="input-group-append">
                <button class="btn btn-outline-primary" type="button" (click)="UploadFile()">
                  Upload</button>
              </div>
            </div>
            <div class="text-left">
              <span class="text-muted font-italic" style="font-size: small;">
                Nếu upload file excel rỗng thì sẽ tự động lấy dữ liệu từ TFS
              </span>
            </div>

          </div>
          <div class="col"></div>
        </div>

        <div class="row">
          <div class="col"></div>
          <div class="col-lg-5 col-md-6 col-sm-8 text-left">

            <div *ngIf="messError" class="alert-danger">
              <span class="text-danger mt-2 wrapper" style="outline: none;">{{messError}}
              </span>

              <a *ngIf="xlsData_Error && xlsData_Error.length> 0" class="text-decoration-none" [routerLink]=""
                routerLinkActive="router-link-active" (click)="ExportFileError()">
                Xuất file lỗi </a>
            </div>

            <div *ngIf="messOK" class="alert-primary">
              <span class="text-primary mt-1 wrapper" style="outline: none;">
                {{messOK}}
              </span>
            </div>
          </div>
          <div class="col"></div>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- File cau truc or File Error  -->
<div class="d-none">
  <table id="excel-table" class="table">
    <thead>
      <tr>
        <th>macase</th>
        <th>matruong</th>
        <th>ngaynhan</th>
        <th>chitietyc</th>
        <th>trangthai</th>
        <th>loaicase</th>
        <th>phanhe</th>
        <!-- <th>ngaydukien</th> -->
        <th>hieuluc</th>
        <th>dabangiao</th>
        <th>ngayemail</th>
        <th>mailto</th>
      </tr>
    </thead>
    <tbody *ngIf="xlsData_Error && xlsData_Error.length>0">
      <tr *ngFor="let item of xlsData_Error; trackBy: trackByFn;">
        <td>{{item.macase}}</td>
        <td>{{item.matruong}}</td>
        <td>{{item.ngaynhan}}</td>
        <td>{{item.chitietyc}}</td>
        <td>{{item.trangthai}}</td>
        <td>{{item.loaicase}}</td>
        <td>{{item.phanhe}}</td>
        <!-- <td>{{item.ngaydukien}}</td> -->
        <td>{{item.hieuluc}}</td>
        <td>{{item.dabangiao}}</td>
        <td>{{item.ngayemail}}</td>
        <td>{{item.mailto}}</td>
      </tr>
    </tbody>
  </table>
</div>